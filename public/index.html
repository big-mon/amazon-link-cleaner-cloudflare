<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Amazon Link Cleaner</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <main class="page">
      <section class="hero">
        <p class="eyebrow">Cloudflare Pages + Pages Functions</p>
        <h1>Amazonリンクを一瞬で展開してクリーン化</h1>
        <p class="lead">
          短縮URLを展開し、アフィリエイトや追跡パラメータを外して正規URLを作ります。
        </p>
      </section>

      <section class="card">
        <form id="clean-form" class="form">
          <label class="label" for="url-input">Amazon URL または amzn.to の短縮URL</label>
          <div class="input-row">
            <input
              id="url-input"
              name="url"
              type="url"
              inputmode="url"
              placeholder="https://amzn.to/xxxxxx"
              autocomplete="off"
              required
            />
            <button id="submit-btn" type="submit">展開してクリーン化</button>
          </div>
          <p id="status" class="status" role="status"></p>
        </form>
      </section>

      <section class="results" aria-live="polite">
        <div class="result">
          <div class="result-header">
            <h2>展開後URL</h2>
            <div class="result-actions">
              <button class="copy-btn" data-copy="expanded">コピー</button>
              <button class="open-btn" data-open="expanded">開く</button>
            </div>
          </div>
          <p id="expanded-url" class="result-value">-</p>
        </div>

        <div class="result">
          <div class="result-header">
            <h2>クリーンURL</h2>
            <div class="result-actions">
              <button class="copy-btn" data-copy="cleaned">コピー</button>
              <button class="open-btn" data-open="cleaned">開く</button>
            </div>
          </div>
          <p id="cleaned-url" class="result-value">-</p>
          <p class="result-sub">ASIN: <span id="asin">-</span></p>
        </div>

        <div class="result">
          <div class="result-header">
            <h2>除去したパラメータ</h2>
          </div>
          <div class="table-wrap">
            <table class="removed-table">
              <thead>
                <tr>
                  <th>Key</th>
                  <th>Value</th>
                </tr>
              </thead>
              <tbody id="removed-body">
                <tr>
                  <td colspan="2">-</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <section class="card note">
        <p>
          エラーになる場合は、Amazon以外のURLが最終URLになっていないか、または短縮URLが無効な可能性があります。
        </p>
      </section>
    </main>

    <script src="/main.js" defer></script>
  </body>
</html>
